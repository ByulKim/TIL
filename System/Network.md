## 네트워크 프로그래밍

* * *

- 데이터를 주고 받는 작업을 네트워킹이라 부르고, 네트워킹은 레이어로 구분하도록 되어 있다.
- `OSI 7 layer` (`Open System Interconnection`)
    - 각 계층에 맞춰 송신자는 인코더, 수신자는 디코더를 가지고 데이터를 변환한다.
    - 1계층 (`Physical layer`)
        - 아날로그 신호를 전달하고, 그를 디지털 신호로 변환하여 해석한다.
        - 전기적인 신호가 나가고 들어오는 것만 담당한다.
        - 하드웨어에 변환하는 부분이 구현되어 있다.

    - 2계층 (`Data-Link layer`)
        - 인터넷 : 전세계의 컴퓨터들이 전선으로 연결되어 있는 것
        - 같은 네트워크에 있는 여러대의 컴퓨터틀이 데이터를 주고받기 위해 필요한 모듈
        - 흐름과 오류, 순서를 제어한다.
        - framing : 앞뒤에 특정 비트열을 붙여 보내는 것
        - 하드웨어에 변환하는 부분이 구현되어 있다. (스위치, 랜카드)

    - 3계층 (`Network layer`)
        - IP( 인터넷 프로토콜)
            - 패킷이라는 통신 단위를 빠르게 목적지로 전달하는 역할
            - 순서가 바뀌거나 일부 누락되더라도 보내는 데 집중한다.
            - 순서가 보장되지 않고, 패킷이 유실되더라도 방안이 없다.
        - 목적지 주소 (ip, 각 컴퓨터의 고유한 주소)
        - 패킷 : ip 주소와 보낼 데이터 묶음 구조체, 객체
        - 라우팅
            - 어디로 보내야하는지 알고 있어 해당 주소로 보내는 것, 최적의 경로를 설정해야 한다.
        - 라우터와 스위치가 다양한 라우팅 프로토콜을 사용하여 경로를 선택한다.
        - 포워딩
            - 라우팅의 경로 선택에 따라 실제로 데이터 패킷을 전송하는 과정이다.
        - 운영체제의 커널에 소프트웨어 적으로 구현되어 있다.

    - 4계층 (`Transport Layer`)
        - 어떤 데이터를 어떤 프로세스에 전달해야 할지 알아야 한다.
        - 포트 번호 : 하나의 컴퓨터에서 동시에 실행되고 있는 여러개의 프로세스들이 고유하게 가져야 하는 번호
        - 도작지 컴퓨터의 최종 프로세스까지 전달
        - 오류 검충 밒 복구, 흐름 제어와 중복 검사 등을 수행한다.
        - 운영체제의 커널에 소프트웨어 적으로 구현되어 있다.
        - 프로토콜
            - TCP (전송 제어 프로토콜)
                - 도착한 데이터 조각을 점검하여 줄을 세우고, 망가졌거나 빠진 조각을 다시 요청한다.
                - 3 way handshaking 을 사용한다.
                    - 실제 데이터를 보내기 전에 가상 연결을 통해 확인하는 동작이다.
                    - 데이터를 상대방에게 확실하게 보내기 위해 사용하는 방법이다.
            - UDP (사용자 데이터그램 프로토콜)
                - 빠르게 패킷을 보내는 목적으로 사용된다.
                - 데이터 전달과 순서를 보장하지 않는다.
                - ip와 같은 형태이지만 포트가 추가된다.
            - UDP는 빠르지만 데이터 전송을 보장할 수 없다.
            - TCP는 데이터 전송이나 순서를 보장하지만 비용이 많이 들고 느리다.

  - 5계층 (`Session layer`)
    - 응용 프로세스가 통신을 관리하기 위한 방법을 정의한다.
        - TCP/IP 세션을 만들고 없애는 역할

  - 6계층 (`Presentation layer`)
    - 전송하는 데이터의 표현 방식을 결정한다.
        - 암호화, 데이터변환, 압축 등

  - 7계층 (`Application Layer`)
    - 현대 인터넷은 TCP/IP 모델을 따라감 (5,6,7계층이 하나로 합쳐짐)
        - 업데이트된 TCP/IP 모델은 1,2계층이 분리됨
    - HTTP
        - 웹에서 정보를 주고 받을 수 있는 프로토콜
    - FTP
        - TCP 환경에서의 파일 전송 프로토콜
  - 각 계층별로 역할이 구분되어 있어, 문제 발생 시 하나의 계층 부분만 확인하면 된다.
  - 자신의 계층 부분만 담당하면 되기에 설계가 편하다.

## Stateful / Stateless

* * *

- 클라이언트의 요청에 대한 처리 방식을 의미한다.

- stateful (상태 유지)
    - 이전 요청의 상태를 기억하고 유지하는 시스템 (클라이언트의 상태 정보를 저장하고 관리한다.)
    - 클라이언트의 상태가 변경될 때마다 이를 감지하고 반영한다.
    - 예시
        - TCP/IP의 3-way handshake
    - 인증 및 세션 정보 (로그인 상태를 유지하는 웹서버)
    - 사용자의 활동 내역
    - 장바구니, 임시 저장 데이터
    - 캐시 데이터
    - 단점
        - 저장하는 데이터의 용량의 한계가 있다.
        - 서버의 장애가 생겨 다른 서버로 변경했을 때 상태를 가지고 있지 않아 장애가 발생할 수 있다.

- stateless (상태 비유지)
    - 상태를 저장하지 않고, 각 요청을 독립적으로 처리한다.
    - 모든 정보는 클라이언트가 가지고 있다가 요청에 함께 실어 보낸다.
    - UDP / HTTP : stateless 한 프로토콜
    - Rest : stateless 한 설계 구조
    - 딘순 API 서버
    - 단점
        - 클라이언트에서 전달하는 내용이 점점 많아질 수 있다.

- 특별한 일이 아니라면 무상태를 유지해야 한다.
    - 서버의 부하를 줄이는 것이 좋다.

- stateful 서버 , stateless 서버
    - stateful 서버
        - 사용자의 이전 상태를 저장하고 있는 서버
        - 세션 정보를 직접 가지고 있으며 사용자를 인증하고 식별한다.
        - 서버의 메모리에 정보를 가지고 있는 경우에 해당된다.
        - 예시
            - 소켓 서버 (stateful한 서버)
                - 클라이언트와의 연결을 생성하고 유지하는 동안 클라이언트의 상태 정보 또한 유지하고 관리한다.
                - 세션을 관리하고, 상태 정보를 공유한다.
            - 게임 서버 (각 플레이어의 상태 정보, 게임 진행 상황등을 유지/관리)
            - 채팅 서버 (채팅 세션 유지, 관리)
            - 온라인 쇼핑 서버 (장바구니, 주문 상태)
            - 로그인 세션 사용 서버
        - 장점
            - 단순하다.
            - 관리가 용이하다.
        - 단점
            - 저장 메모리가 필요하다.
            - 확장하기 어렵다.
    - stateless 서버
        - 사용자의 이전 상태를 저장하고 있지 않는 서버
        - https 는 stateless한 프로토콜
        - 토큰 같은것을 통해 인증하고 사용자를 식별한다.
        - 데이터를 외부 저장소에 저장하고 사용하는 경우, stateless한 것으로 간주된다.
        - 장점
            - 상대적으로 가볍다.
            - 확장하기 쉽다.
        - 단점
            - 관리가 어렵다.
            - 탈취에 대해 취약하다.