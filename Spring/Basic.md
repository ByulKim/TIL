# 스프링 기본 개념

### 컨테이너(Container)

* * *

- 스프링 애플리케이션 내부에서 실행되는 객체 관리 시스템
- 스프링 어플리케이션이 실행될 때 생성된다.


- 생성
    - 명시적으로 생성하고 초기화 해야 한다. (설정클래스/XML/스프링 부트 등을 통해)
    - 스프링 부트에서는 자동 설정과 의존성 주입을 통해 조금 더 쉽게 어플리케이션을 구성할 수 있다.
    - 하나의 컨테이너를 사용하여 어플리케이션의 전체 빈을 관리할 수도 있고,모듈별로 별도의 컨테이너를 사용할 수도 있다.
    - 상위-하위 관계의 계층형 컨테이너 구조도 가능하며,하위 컨테이너는 상위 컨테이너의 빈을 참조할 수 있다.


- 역할
    - 객체 관리: 어플리케이션 내부에서 사용되는 객체(빈) 생성/관리
    - 의존성 주입: 객체간의 의존성을 주입
    - 빈 사이클 관리: 객체의 생성-초기화-사용-소멸 등의 라이프 사이클을 관리
    - AOP 지원: 공통 관심사를 모듈화하고 적용
    - 환경 설정 및 프로퍼티 관리: 어플리케이션의 설정 정보와 프로퍼티 관리

### 빈(Bean)

* * *

- 스프링 컨테이너에 의해 생성되고 관리되는 객체
- 단순한 객체와 구분하기 위해 ‘빈’이라는 용어를 사용한다.
- new를 통해 객체를 생성하는 것이 아니라 컨테이너에게 요청하여 반환받아 사용한다.

### 빈 스코프(Scope)

* * *

- 빈의 생명주기 기간을 정의한다.


- 싱글톤 스코프
    - 스프링 컨테이너가 초기화 될 때 모든 싱글톤 빈을 한 번 생성한다.
    - 그 후 해당 빈을 사용할 때 항상 같은 인스턴스를 반환한다.
    - 생성된 빈은 스프링 컨테이너가 참조를 유지하므로 가비지컬렉터에 의해 삭제되지 않고 어플리케이션이 종료될 때까지 유지한다.
        - 어플리케이션이 종료될 때 컨테이너가 빈에 대한 참조를 해제하고, 가비지컬렉터에 의해 메모리에서 삭제된다.
    - 지연 초기화
        - 불필요한 빈이 미리 생성되어 메모리를 차지하는 것을 방지하기 위해 실제 빈이 사용되는 순간 생성되도록 지연 초기화 방식을 사용한다.
        - 개별 빈에 설정하거나, 전체에 설정할 수 있다.
        - 빈의 생성비용이 높고, 자주 사용되지 않는다면 지연 초기화 하는 것이 좋을 수 있다.
        - 의존 관계나(지연 초기화된 빈을 의존하는 경우) 초기화 시점을 고려하여 설정해야 한다.
    - 동시성 문제
        - 하나의 인스턴스를 여러 쓰레드에서 공유하는 경우 동시성 문제가 발생할 수 있다.
        - 상태를 유지하지 않는 로직으로 설계하거나 지역변수들을 사용하여 동시성 문제를 방지할 수 있다.
        - 싱글톤 빈 안에 프로토타입 빈을 주입해두면, 사용시마다 새로운 프로토타입 빈이 생성되기 때문에변하는 값의 경우에는 프로토타입 빈을 이용해 관리할 수도 있다.


- 프로토타입 스코프
    - 빈이 요청될 때마다 새로운 인스턴스를 생성한다.


- 요청 스코프
    - 각 HTTP 요청마다 새로운 인스턴스를 생성한다.


- 세션 스코프
    - 각 HTTP 세션마다 새로운 인스턴스를 생성한다.

### DI / IoC

* * *

- IoC : 제어의 역전 원칙 Inversion of Control
    - 객체의 생명주기와 의존성 관리, 프로그램의 흐름을 개발자가 아닌 프레임워크, 컨테이너에서 처리하는 것이다.
    - 객체를 직접 생성하고 관리하는 단순 반복 개발을 프레임워크가 대신 하기 때문에**생산성**이 향상되고, 개발자는 비즈니스 로직 개발에 취중할 수 있다.


- 스프링에서 제어의 역전 원칙을 구현하기 위한 매커니즘
    1. DI
        - 객체의 의존성을 외부에서 주입하는 것이다.
        - 의존성을 외부에서 직접 주입하는 것
            - 객체의 생성 및 주입을 직접 진행해야 하므로, 코드가 분산되고 복잡해질 수 있다.
            - 의존을 맺는 구현체를 변경해야 한다면, 주입되는 부분을 모두 찾아 수정해 주어야 한다.
            - 테스트 코드 작성시에 의존하고 있는 모든 객체를 직접 주입해야 하므로 복잡해질 수 있다.
        - 프레임워크(스프링)을 통해 주입하는 것
            - 객체의 생성 및 주입을 자동화하여 설정 후 호출만 하면 된다.
            - 구성의 변경 시 설정 부분만 변경하면 되기 때문에 변경에 용이하다.
            - 테스트 시에도 의존성이 설정되어 있기 때문에 모킹하거나 대체할 수 있어 테스트에 용이하다.
            - 코드의 재사용성, 유연성, 테스트 용이성, 유지보수성이 향상된다.
    2. 빈 스코프
        - 객체의 생명주기를 관리하여 생성 및 소멸 처리
    3. AOP
        - 어플리케이션의 핵심 로직과 횡단 관심사를 분리하는 것이다.
        - 런타임시에 특정 코드를 주입하여 변동되는 비즈니스 로직은 간결하게 유지하고, 공통 기능을 재사용한다.
    4. 이벤트 프로그래밍 모델
        - 이벤트의 발행과 처리를 프레임워크가 관리한다.
    5. 환경 설정 및 프로파일 관리
    6. 트랜잭션 관리